<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Design System – Zipline</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Azeret+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', sans-serif;
      background: #fff;
      color: #334155;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* ── Proto nav ── */
    .proto-nav {
      position: fixed; top: 0; left: 0; right: 0;
      z-index: 9999; height: 40px; background: #000;
      display: flex; align-items: center; gap: 12px; padding: 0 16px;
      font-family: 'Inter', system-ui, sans-serif;
      flex-shrink: 0;
    }
    .proto-nav-library {
      display: flex; align-items: center; gap: 8px;
      text-decoration: none; color: #fff; font-size: 14px; font-weight: 500;
      letter-spacing: -0.28px; line-height: 24px; white-space: nowrap; flex-shrink: 0;
    }
    .proto-nav-library:hover { opacity: 0.75; }
    .proto-nav-library svg { width: 20px; height: 20px; flex-shrink: 0; }
    .proto-nav-title { flex: 1; color: #fff; font-size: 14px; font-weight: 500; letter-spacing: -0.28px; line-height: 24px; }
    .proto-nav-updated { flex: 1; color: #fff; font-size: 14px; font-weight: 400; letter-spacing: -0.28px; line-height: 24px; text-align: right; white-space: nowrap; }
    body { padding-top: 40px; }

    /* ── Page header ── */
    .page-header {
      padding: 24px 40px;
      flex-shrink: 0;
      border-bottom: 1px solid #e2e8f0;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo { height: 23px; display: flex; align-items: center; }
    .logo img { width: 100px; height: 23px; object-fit: contain; }
    .check-btn {
      display: inline-flex; align-items: center; gap: 8px;
      background: #f1f5f9; border: 1px solid #e2e8f0; border-radius: 8px;
      padding: 7px 14px; cursor: pointer;
      font-family: inherit; font-size: 13px; font-weight: 500;
      color: #334155; letter-spacing: -0.26px; line-height: 20px;
      transition: background 0.15s, border-color 0.15s;
    }
    .check-btn:hover { background: #e2e8f0; border-color: #cbd5e1; }
    .check-btn svg { width: 16px; height: 16px; flex-shrink: 0; color: #64748b; }
    .check-btn.running { opacity: 0.6; pointer-events: none; }
    /* ── Check-result overlay ── */
    .check-overlay {
      position: fixed; inset: 0; z-index: 20000;
      background: rgba(15,23,42,0.5);
      display: flex; align-items: center; justify-content: center;
      opacity: 0; pointer-events: none; transition: opacity 0.2s;
    }
    .check-overlay.is-open { opacity: 1; pointer-events: auto; }
    .check-dialog {
      background: #fff; border-radius: 12px; padding: 24px;
      width: 480px; max-width: calc(100vw - 32px);
      max-height: calc(100vh - 64px); overflow-y: auto;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      display: flex; flex-direction: column; gap: 16px;
      transform: scale(0.96); transition: transform 0.2s;
    }
    .check-overlay.is-open .check-dialog { transform: scale(1); }
    .check-dialog-header { display: flex; align-items: center; justify-content: space-between; }
    .check-dialog-title { font-size: 16px; font-weight: 600; color: #0f172a; letter-spacing: -0.32px; }
    .check-close { background: none; border: none; cursor: pointer; color: #64748b; padding: 2px; display: flex; border-radius: 4px; }
    .check-close:hover { background: #f1f5f9; }
    .check-close svg { width: 20px; height: 20px; }
    .check-result-item {
      display: flex; align-items: flex-start; gap: 10px;
      padding: 10px 12px; border-radius: 8px; background: #f8fafc;
      border: 1px solid #e2e8f0;
    }
    .check-result-item svg { width: 16px; height: 16px; flex-shrink: 0; margin-top: 2px; }
    .check-result-item .ri-label { font-size: 13px; font-weight: 600; color: #0f172a; letter-spacing: -0.26px; line-height: 20px; }
    .check-result-item .ri-detail { font-size: 12px; color: #64748b; line-height: 18px; }
    .check-result-empty { text-align: center; color: #059669; font-size: 14px; font-weight: 500; padding: 16px 0; }
    .check-result-list { display: flex; flex-direction: column; gap: 8px; }

    /* ── Main 3-col layout ── */
    .main {
      flex: 1;
      min-height: 0;
      display: flex;
    }

    /* ── Left: Nav column (search + scrollable list) ── */
    .nav-col {
      width: 240px;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      border-right: 1px solid #e2e8f0;
    }
    .nav-search-wrap {
      padding: 12px 8px 10px;
      flex-shrink: 0;
      border-bottom: 1px solid #e2e8f0;
    }
    .nav-search-inner {
      display: flex;
      align-items: center;
      gap: 7px;
      padding: 6px 10px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      background: #f8fafc;
      transition: border-color 0.15s, box-shadow 0.15s;
    }
    .nav-search-inner:focus-within {
      border-color: #2c66ef;
      box-shadow: 0 0 0 3px rgba(44,102,239,0.08);
      background: #fff;
    }
    .nav-search-inner svg { width: 14px; height: 14px; flex-shrink: 0; color: #94a3b8; }
    .nav-search {
      flex: 1; border: none; background: none; outline: none;
      font-family: inherit; font-size: 13px; color: #334155;
      letter-spacing: -0.26px; line-height: 20px;
    }
    .nav-search::placeholder { color: #94a3b8; }
    .nav-panel {
      flex: 1;
      overflow-y: auto;
      padding: 8px 8px;
    }
    .cat-group { display: flex; flex-direction: column; }
    .cat-header {
      display: flex;
      align-items: center;
      padding: 8px 8px 8px 8px;
      cursor: pointer;
      border: none;
      background: none;
      font-family: inherit;
      font-size: 14px;
      font-weight: 500;
      color: #1e293b;
      letter-spacing: -0.28px;
      line-height: 24px;
      width: 100%;
      text-align: left;
      border-radius: 6px;
      gap: 8px;
    }
    .cat-header:hover { background: #f8fafc; }
    .cat-chevron {
      width: 16px; height: 16px; flex-shrink: 0;
      margin-left: auto;
      transition: transform 0.2s;
      color: #94a3b8;
    }
    .cat-header.open .cat-chevron { transform: rotate(180deg); }

    .cat-items { display: none; flex-direction: column; padding: 2px 0 4px 0; }
    .cat-items.open { display: flex; }

    .cat-item-wrap { display: flex; align-items: stretch; padding: 0 0 0 8px; }
    .cat-item-tree {
      width: 20px;
      flex-shrink: 0;
      position: relative;
    }
    .cat-item-tree::before {
      content: '';
      position: absolute;
      left: 7px;
      top: 0;
      bottom: 0;
      width: 1px;
      background: #e2e8f0;
    }
    .cat-item-wrap:last-child .cat-item-tree::before { bottom: 50%; }
    .cat-item-tree::after {
      content: '';
      position: absolute;
      left: 7px;
      top: 50%;
      width: 10px;
      height: 1px;
      background: #e2e8f0;
    }
    .cat-item {
      flex: 1;
      min-width: 0;
      padding: 4px 8px;
      background: none;
      border: none;
      font-family: inherit;
      font-size: 13px;
      font-weight: 400;
      color: #475569;
      letter-spacing: -0.26px;
      line-height: 22px;
      text-align: left;
      cursor: pointer;
      border-radius: 6px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin: 1px 4px 1px 0;
    }
    .cat-item:hover { background: #f1f5f9; color: #1e293b; }
    .cat-item.active { background: #eff6ff; color: #2c66ef; font-weight: 500; }

    /* ── Middle: Preview panel ── */
    .preview-panel {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      border-right: 1px solid #e2e8f0;
      overflow: hidden;
    }
    .preview-name {
      padding: 12px 40px;
      font-size: 18px;
      font-weight: 600;
      color: #334155;
      letter-spacing: -0.36px;
      line-height: 26px;
      flex-shrink: 0;
      border-bottom: 1px solid #e2e8f0;
    }
    .preview-canvas {
      flex: 1;
      min-height: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f8fafc;
      padding: 40px;
      overflow: auto;
    }
    .preview-empty {
      color: #94a3b8;
      font-size: 14px;
      text-align: center;
      line-height: 24px;
    }

    /* ── Right: Specs panel ── */
    .specs-panel {
      width: 380px;
      flex-shrink: 0;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }
    .specs-heading {
      padding: 12px 24px;
      font-size: 18px;
      font-weight: 600;
      color: #334155;
      letter-spacing: -0.36px;
      line-height: 26px;
      flex-shrink: 0;
      border-bottom: 1px solid #e2e8f0;
    }
    .specs-body {
      padding: 20px 24px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    .specs-empty {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #94a3b8;
      font-size: 14px;
      padding: 40px;
      text-align: center;
      line-height: 24px;
    }
    .spec-block { display: flex; flex-direction: column; }
    .spec-card {
      display: flex;
      flex-direction: column;
    }
    .spec-card-header {
      padding: 8px 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .spec-card-label {
      flex: 1;
      font-size: 12px;
      font-weight: 600;
      color: #334155;
      letter-spacing: -0.24px;
      line-height: 16px;
    }
    .spec-card-divider { display: none; }
    .spec-code {
      display: block;
      padding: 16px;
      font-family: 'Azeret Mono', 'SF Mono', 'Fira Code', monospace;
      font-size: 13px;
      font-weight: 400;
      line-height: 20px;
      color: #f8fafc;
      background: #0f172a;
      border-radius: 8px;
      white-space: pre;
      overflow-x: auto;
      max-height: 300px;
      overflow-y: auto;
    }
    .spec-copy-btn {
      background: none;
      border: none;
      padding: 2px;
      cursor: pointer;
      color: #334155;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      flex-shrink: 0;
      transition: background 0.15s, color 0.15s;
    }
    .spec-copy-btn:hover { background: rgba(0,0,0,0.08); }
    .spec-copy-btn svg { width: 20px; height: 20px; }
    .spec-copy-btn.copied { color: #059669; }

    /* ── Used on ── */
    .used-on-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .used-on-link {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 0;
      border-radius: 6px;
      text-decoration: none;
      color: #334155;
      font-size: 16px;
      font-weight: 600;
      letter-spacing: -0.32px;
      line-height: 26px;
      transition: color 0.12s;
    }
    .used-on-link:hover { color: #2c66ef; }
    .used-on-link svg { width: 24px; height: 24px; flex-shrink: 0; color: #64748b; transition: color 0.12s; }
    .used-on-link:hover svg { color: #2c66ef; }
  </style>
</head>
<body>

  <!-- Proto nav bar -->
  <nav class="proto-nav">
    <span class="proto-nav-title">Design System</span>
    <a href="index.html" class="proto-nav-library">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
      </svg>
      Library
    </a>
    <span class="proto-nav-updated" id="protoLastUpdated" style="flex:0 0 auto;"></span>
  </nav>

  <!-- Page header -->
  <div class="page-header">
    <div class="logo">
      <img src="https://www.figma.com/api/mcp/asset/73914091-8657-4909-81c6-dce51488ce2a" alt="Zipline" />
    </div>
    <button class="check-btn" id="checkBtn" onclick="checkForNewComponents()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
      </svg>
      Check for new components
    </button>
  </div>
  <!-- Check result overlay -->
  <div class="check-overlay" id="checkOverlay">
    <div class="check-dialog">
      <div class="check-dialog-header">
        <span class="check-dialog-title" id="checkDialogTitle">Checking…</span>
        <button class="check-close" onclick="document.getElementById('checkOverlay').classList.remove('is-open')" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>
      <div id="checkResultBody"></div>
    </div>
  </div>

  <!-- Three-column body -->
  <div class="main">
    <div class="nav-col">
      <div class="nav-search-wrap">
        <div class="nav-search-inner">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/><path stroke-linecap="round" d="M21 21l-4.35-4.35"/>
          </svg>
          <input class="nav-search" id="navSearch" type="text" placeholder="Search components…" autocomplete="off" />
        </div>
      </div>
      <nav class="nav-panel" id="navPanel"></nav>
    </div>
    <div class="preview-panel">
      <div class="preview-name" id="previewName">Select a component</div>
      <div class="preview-canvas" id="previewCanvas">
        <div class="preview-empty">← Choose a component from the left panel</div>
      </div>
    </div>
    <aside class="specs-panel">
      <div class="specs-heading">Specs</div>
      <div id="specsBody" class="specs-empty">Select a component to view its CSS and HTML snippets.</div>
    </aside>
  </div>

  <script>
    // ─── Component Data ───────────────────────────────────────────────────────
    const DS = [
      {
        category: 'Buttons',
        items: [
          {
            name: 'Primary Button',
            previewCSS: `.ds-btn-primary {
  background: #2c66ef; color: #fff; border: none;
  border-radius: 8px; padding: 4px 12px;
  font-family: Inter, sans-serif; font-size: 14px;
  font-weight: 500; letter-spacing: -0.56px; line-height: 24px;
  display: inline-flex; align-items: center; gap: 8px; cursor: pointer;
}
.ds-btn-primary:hover { background: #1d56df; }`,
            previewHTML: `<button class="ds-btn-primary">Continue</button>`,
            css: `.btn-primary {
  background: #2c66ef;
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 4px 12px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.56px;
  line-height: 24px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
}
.btn-primary:hover { background: #1d56df; }`,
            html: `<button class="btn-primary">Continue</button>`
          },
          {
            name: 'Secondary Button',
            previewCSS: `.ds-btn-secondary {
  background: #e2e8f0; color: #0f172a; border: none;
  border-radius: 8px; padding: 4px 12px;
  font-family: Inter, sans-serif; font-size: 14px;
  font-weight: 500; letter-spacing: -0.56px; line-height: 24px;
  display: inline-flex; align-items: center; gap: 8px; cursor: pointer;
}
.ds-btn-secondary:hover { background: #cbd5e1; }`,
            previewHTML: `<button class="ds-btn-secondary">Back</button>`,
            css: `.btn-secondary {
  background: #e2e8f0;
  color: #0f172a;
  border: none;
  border-radius: 8px;
  padding: 4px 12px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.56px;
  line-height: 24px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
}
.btn-secondary:hover { background: #cbd5e1; }`,
            html: `<button class="btn-secondary">Back</button>`
          },
          {
            name: 'Outline Button',
            previewCSS: `.ds-btn-outline {
  border: 1px solid #2c66ef; color: #2c66ef; background: #fff;
  font-family: Inter, sans-serif; font-size: 14px;
  font-weight: 500; letter-spacing: -0.56px; line-height: 24px;
  padding: 4px 12px; border-radius: 8px; cursor: pointer;
  display: inline-flex; align-items: center;
}
.ds-btn-outline:hover { background: #eff6ff; }`,
            previewHTML: `<button class="ds-btn-outline">Cancel</button>`,
            css: `.btn-outline {
  border: 1px solid #2c66ef;
  color: #2c66ef;
  background: #fff;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.56px;
  line-height: 24px;
  padding: 4px 12px;
  border-radius: 8px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
}
.btn-outline:hover { background: #eff6ff; }`,
            html: `<button class="btn-outline">Cancel</button>`
          },
          {
            name: 'Disabled Button',
            previewCSS: `.ds-btn-disabled {
  background: #e2e8f0; color: #94a3b8; border: none;
  border-radius: 20px; padding: 7px 24px;
  font-family: Inter, sans-serif; font-size: 16px;
  font-weight: 700; line-height: 26px; cursor: not-allowed;
}`,
            previewHTML: `<button class="ds-btn-disabled" disabled>Continue</button>`,
            css: `.btn-disabled {
  background: #e2e8f0;
  color: #94a3b8;
  border: none;
  border-radius: 20px;
  padding: 7px 24px;
  font-size: 16px;
  font-weight: 700;
  line-height: 26px;
  cursor: not-allowed;
}`,
            html: `<button class="btn-disabled" disabled>Continue</button>`
          },
          {
            name: 'Pill Button (Active)',
            previewCSS: `.ds-btn-pill {
  background: #197fe6; color: #fff; border: none;
  border-radius: 20px; padding: 7px 24px;
  font-family: Inter, sans-serif; font-size: 16px;
  font-weight: 700; line-height: 26px; cursor: pointer;
  transition: background 0.15s;
}
.ds-btn-pill:hover { background: #1569c8; }`,
            previewHTML: `<button class="ds-btn-pill">Continue</button>`,
            css: `.btn-pill-active {
  background: #197fe6;
  color: #fff;
  border: none;
  border-radius: 20px;
  padding: 7px 24px;
  font-size: 16px;
  font-weight: 700;
  line-height: 26px;
  cursor: pointer;
  transition: background 0.15s;
}
.btn-pill-active:hover { background: #1569c8; }`,
            html: `<button class="btn-pill-active">Continue</button>`
          }
        ]
      },
      {
        category: 'Form Controls',
        items: [
          {
            name: 'Text Input',
            previewCSS: `.ds-field-wrap { display: flex; flex-direction: column; gap: 6px; font-family: Inter, sans-serif; }
.ds-field-label { font-size: 16px; font-weight: 600; color: #0f172a; letter-spacing: -0.32px; line-height: 26px; }
.ds-field-input {
  width: 280px; height: 40px; border: 2px solid #ccc;
  border-radius: 8px; padding: 0 12px;
  font-family: Inter, sans-serif; font-size: 16px; color: #0f172a;
  background: #fff; outline: none; transition: border-color 0.15s, box-shadow 0.15s;
}
.ds-field-input:focus { border-color: #2c66ef; box-shadow: 0 0 0 3px rgba(44,102,239,0.1); }
.ds-field-input::placeholder { color: #808080; }`,
            previewHTML: `<div class="ds-field-wrap">
  <label class="ds-field-label">First Name <span style="color:#ef4444">*</span></label>
  <input class="ds-field-input" type="text" placeholder="Enter first name" />
</div>`,
            css: `.field-label {
  font-size: 16px;
  font-weight: 600;
  color: #0f172a;
  letter-spacing: -0.32px;
  line-height: 26px;
}
.field-label .star { color: #ef4444; }

.field-input {
  width: 100%;
  height: 40px;
  border: 2px solid #ccc;
  border-radius: 8px;
  padding: 0 12px;
  font-size: 16px;
  color: #0f172a;
  background: #fff;
  outline: none;
  transition: border-color 0.15s, box-shadow 0.15s;
}
.field-input:focus {
  border-color: #2c66ef;
  box-shadow: 0 0 0 3px rgba(44,102,239,0.1);
}
.field-input::placeholder { color: #808080; }`,
            html: `<label class="field-label">
  First Name <span class="star">*</span>
</label>
<input
  class="field-input"
  type="text"
  placeholder="Enter first name"
/>`
          },
          {
            name: 'Select',
            previewCSS: `.ds-field-select {
  width: 280px; height: 40px; border: 2px solid #ccc;
  border-radius: 8px; padding: 0 36px 0 12px;
  font-family: Inter, sans-serif; font-size: 16px; color: #808080;
  background: #fff url("data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23334155' stroke-width='2' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19 9l-7 7-7-7'/%3E%3C/svg%3E") no-repeat right 12px center;
  appearance: none; outline: none; cursor: pointer;
  transition: border-color 0.15s, box-shadow 0.15s;
}
.ds-field-select:focus { border-color: #2c66ef; box-shadow: 0 0 0 3px rgba(44,102,239,0.1); }`,
            previewHTML: `<select class="ds-field-select">
  <option value="" disabled selected>Select a role</option>
  <option>Nurse</option>
  <option>Carer</option>
  <option>Admin</option>
</select>`,
            css: `.field-select {
  width: 100%;
  height: 40px;
  border: 2px solid #ccc;
  border-radius: 8px;
  padding: 0 36px 0 12px;
  font-size: 16px;
  color: #808080;
  background: #fff url("data:image/svg+xml,…")
              no-repeat right 12px center;
  appearance: none;
  outline: none;
  cursor: pointer;
  transition: border-color 0.15s, box-shadow 0.15s;
}
.field-select:focus {
  border-color: #2c66ef;
  box-shadow: 0 0 0 3px rgba(44,102,239,0.1);
}
.field-select.has-value { color: #0f172a; }`,
            html: `<select class="field-select">
  <option value="" disabled selected>
    Select a role
  </option>
  <option>Nurse</option>
  <option>Carer</option>
</select>`
          },
          {
            name: 'Checkbox',
            previewCSS: `.ds-cb-row { display:flex; align-items:flex-start; gap:10px; cursor:pointer; font-family:Inter,sans-serif; }
.ds-cb-wrap { flex-shrink:0; width:20px; height:20px; position:relative; margin-top:3px; }
.ds-cb-wrap input { opacity:0; position:absolute; inset:0; cursor:pointer; margin:0; width:100%; height:100%; }
.ds-cb-custom { width:20px; height:20px; border:2px solid #ccc; border-radius:4px; background:#fff; display:flex; align-items:center; justify-content:center; pointer-events:none; transition:background 0.12s,border-color 0.12s; }
.ds-cb-custom svg { width:12px; height:12px; display:none; }
.ds-cb-wrap input:checked ~ .ds-cb-custom { background:#197fe6; border-color:#197fe6; }
.ds-cb-wrap input:checked ~ .ds-cb-custom svg { display:block; }
.ds-cb-text { font-size:16px; font-weight:400; line-height:26px; color:#54565a; }`,
            previewHTML: `<label class="ds-cb-row">
  <div class="ds-cb-wrap">
    <input type="checkbox" checked />
    <div class="ds-cb-custom">
      <svg viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3">
        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
      </svg>
    </div>
  </div>
  <span class="ds-cb-text">I agree to the terms and conditions</span>
</label>`,
            css: `.checkbox-wrap {
  flex-shrink: 0;
  width: 20px;
  height: 20px;
  position: relative;
  margin-top: 3px;
}
.checkbox-wrap input {
  opacity: 0;
  position: absolute;
  inset: 0;
  cursor: pointer;
  margin: 0;
}
.checkbox-custom {
  width: 20px;
  height: 20px;
  border: 2px solid #ccc;
  border-radius: 4px;
  background: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  transition: background 0.12s, border-color 0.12s;
}
.checkbox-wrap input:checked ~ .checkbox-custom {
  background: #197fe6;
  border-color: #197fe6;
}`,
            html: `<label class="checkbox-row">
  <div class="checkbox-wrap">
    <input type="checkbox" />
    <div class="checkbox-custom">
      <svg viewBox="0 0 24 24" fill="none"
           stroke="#fff" stroke-width="3">
        <path stroke-linecap="round"
              stroke-linejoin="round"
              d="M5 13l4 4L19 7"/>
      </svg>
    </div>
  </div>
  <span class="checkbox-text">Label</span>
</label>`
          },
          {
            name: 'Inline Field Edit',
            previewCSS: `.ds-ifield { display:flex; flex-direction:column; gap:4px; font-family:Inter,sans-serif; width:260px; }
.ds-ifield-label { font-size:16px; font-weight:600; color:#0f172a; letter-spacing:-0.32px; line-height:26px; }
.ds-ifield-value-wrap { display:flex; align-items:center; gap:8px; width:100%; }
.ds-ifield-value { font-size:16px; color:#0f172a; line-height:26px; flex:1; }
.ds-ifield-edit-btn { background:none; border:none; cursor:pointer; padding:0; color:#2c66ef; display:flex; align-items:center; }
.ds-ifield-edit-btn svg { width:20px; height:20px; }
.ds-ifield-edit-btn:hover { opacity:0.75; }
.ds-edit-form { display:flex; flex-direction:column; gap:8px; width:100%; }
.ds-edit-input { width:100%; padding:10px 12px; border:1px solid #2c66ef; border-radius:8px; font-family:Inter,sans-serif; font-size:16px; color:#0f172a; outline:none; background:#fff; box-shadow:0 0 0 3px rgba(44,102,239,0.1); }
.ds-edit-actions { display:flex; align-items:center; gap:8px; justify-content:flex-end; }
.ds-btn-cancel-il { background:#e2e8f0; border:none; color:#0f172a; font-family:Inter,sans-serif; font-size:14px; font-weight:500; letter-spacing:-0.28px; padding:4px 12px; border-radius:8px; cursor:pointer; }
.ds-btn-cancel-il:hover { background:#cbd5e1; }
.ds-btn-save-il { background:#2c66ef; border:none; color:#fff; font-family:Inter,sans-serif; font-size:14px; font-weight:500; letter-spacing:-0.28px; padding:4px 12px; border-radius:8px; cursor:pointer; }`,
            previewHTML: `<div style="display:flex;gap:40px;align-items:flex-start;flex-wrap:wrap;font-family:Inter,sans-serif">
  <div>
    <div style="font-size:11px;font-weight:600;color:#94a3b8;letter-spacing:0.6px;text-transform:uppercase;margin-bottom:10px">Read</div>
    <div class="ds-ifield">
      <div class="ds-ifield-label">ABN</div>
      <div class="ds-ifield-value-wrap">
        <span class="ds-ifield-value">12 345 678 901</span>
        <button class="ds-ifield-edit-btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
        </button>
      </div>
    </div>
  </div>
  <div>
    <div style="font-size:11px;font-weight:600;color:#94a3b8;letter-spacing:0.6px;text-transform:uppercase;margin-bottom:10px">Editing</div>
    <div class="ds-ifield">
      <div class="ds-ifield-label">ABN</div>
      <div class="ds-edit-form">
        <input class="ds-edit-input" type="text" value="12 345 678 901" />
        <div class="ds-edit-actions">
          <button class="ds-btn-cancel-il">Cancel</button>
          <button class="ds-btn-save-il">Save</button>
        </div>
      </div>
    </div>
  </div>
</div>`,
            css: `.field-row {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.field-label {
  font-size: 16px; font-weight: 600;
  color: #0f172a; letter-spacing: -0.32px; line-height: 26px;
}
/* Read state */
.field-value-wrap {
  display: flex; align-items: center; gap: 8px;
}
.field-value {
  font-size: 16px; color: #0f172a;
  line-height: 26px; flex: 1;
}
.field-edit-btn {
  background: none; border: none; cursor: pointer;
  padding: 0; color: #2c66ef;
  display: flex; align-items: center;
}
.field-edit-btn svg { width: 20px; height: 20px; }
.field-edit-btn:hover { opacity: 0.75; }
/* Edit state */
.edit-form { display: flex; flex-direction: column; gap: 8px; }
.edit-input {
  width: 100%; padding: 10px 12px;
  border: 1px solid #cbd5e1; border-radius: 8px;
  font-size: 16px; color: #0f172a;
  outline: none; background: #fff;
  transition: border-color 0.15s, box-shadow 0.15s;
}
.edit-input:focus {
  border-color: #2c66ef;
  box-shadow: 0 0 0 3px rgba(44,102,239,0.1);
}
.edit-actions {
  display: flex; gap: 8px; justify-content: flex-end;
}
.btn-cancel-inline {
  background: #e2e8f0; border: none; color: #0f172a;
  font-size: 14px; font-weight: 500;
  padding: 4px 12px; border-radius: 8px; cursor: pointer;
}
.btn-cancel-inline:hover { background: #cbd5e1; }
.btn-save-inline {
  background: #2c66ef; border: none; color: #fff;
  font-size: 14px; font-weight: 500;
  padding: 4px 12px; border-radius: 8px; cursor: pointer;
}`,
            html: `<!-- Read state -->
<div class="field-row">
  <div class="field-label">ABN</div>
  <div class="field-value-wrap">
    <span class="field-value">12 345 678 901</span>
    <button class="field-edit-btn"
            onclick="startEdit(this)">
      <svg viewBox="0 0 24 24" fill="none"
           stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round"
              stroke-linejoin="round"
              d="M15.232 5.232l3.536 3.536m-2.036-5.036
                 a2.5 2.5 0 113.536 3.536L6.5 21.036H3
                 v-3.572L16.732 3.732z"/>
      </svg>
    </button>
  </div>
</div>

<!-- Edit state -->
<div class="field-row">
  <div class="field-label">ABN</div>
  <div class="edit-form">
    <input class="edit-input" type="text"
           value="12 345 678 901" />
    <div class="edit-actions">
      <button class="btn-cancel-inline"
              onclick="cancelEdit(this)">Cancel</button>
      <button class="btn-save-inline"
              onclick="saveEdit(this)">Save</button>
    </div>
  </div>
</div>`
          }
        ]
      },
      {
        category: 'Badges & Tags',
        items: [
          {
            name: 'Tag: Caution',
            previewCSS: `.ds-tag-caution {
  display:inline-flex; padding:4px 8px;
  border:2px solid #ffeabf; border-radius:8px;
  font-family:Inter,sans-serif; font-size:12px; font-weight:700;
  color:#ffaa00; line-height:16px;
}`,
            previewHTML: `<span class="ds-tag-caution">Approval required</span>`,
            css: `.tag-caution {
  display: inline-flex;
  padding: 4px 8px;
  border: 2px solid #ffeabf;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 700;
  color: #ffaa00;
  line-height: 16px;
}`,
            html: `<span class="tag-caution">Approval required</span>`
          },
          {
            name: 'Status: Approved',
            previewCSS: `.ds-status-pill { display:inline-flex; align-items:center; gap:4px; padding:2px 6px; border-radius:12px; font-family:Inter,sans-serif; font-size:12px; font-weight:600; letter-spacing:-0.24px; line-height:16px; }
.ds-dot { width:6px; height:6px; border-radius:50%; flex-shrink:0; }
.ds-status-approved { background:#a7f3d0; color:#059669; }
.ds-status-approved .ds-dot { background:#059669; }`,
            previewHTML: `<span class="ds-status-pill ds-status-approved">
  <span class="ds-dot"></span>Approved
</span>`,
            css: `.status-pill {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 6px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 600;
  letter-spacing: -0.24px;
  line-height: 16px;
}
.status-pill .dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}
.status-approved { background: #a7f3d0; color: #059669; }
.status-approved .dot { background: #059669; }`,
            html: `<span class="status-pill status-approved">
  <span class="dot"></span>
  Approved
</span>`
          },
          {
            name: 'Status: In Review',
            previewCSS: `.ds-status-pill2 { display:inline-flex; align-items:center; gap:4px; padding:2px 6px; border-radius:12px; font-family:Inter,sans-serif; font-size:12px; font-weight:600; letter-spacing:-0.24px; line-height:16px; }
.ds-dot2 { width:6px; height:6px; border-radius:50%; flex-shrink:0; }
.ds-status-review { background:#bfdbfe; color:#2563eb; }
.ds-status-review .ds-dot2 { background:#2563eb; }`,
            previewHTML: `<span class="ds-status-pill2 ds-status-review">
  <span class="ds-dot2"></span>In review
</span>`,
            css: `.status-in-review {
  background: #bfdbfe;
  color: #2563eb;
}
.status-in-review .dot { background: #2563eb; }`,
            html: `<span class="status-pill status-in-review">
  <span class="dot"></span>
  In review
</span>`
          },
          {
            name: 'Badge: Count',
            previewCSS: `.ds-badge {
  background:#ef4444; color:#fff;
  font-family:Inter,sans-serif; font-size:10px; font-weight:600;
  line-height:11px; padding:2px 6px; border-radius:12px;
  display:inline-flex; align-items:center;
}`,
            previewHTML: `<span class="ds-badge">4</span>`,
            css: `.badge {
  background: #ef4444;
  color: #fff;
  font-size: 10px;
  font-weight: 600;
  line-height: 11px;
  padding: 2px 6px;
  border-radius: 12px;
  display: inline-flex;
  align-items: center;
}`,
            html: `<span class="badge">4</span>`
          },
          {
            name: 'Status Badge (Dot)',
            previewCSS: `.ds-status-pill { display:inline-flex; align-items:center; gap:5px; padding:3px 8px; border-radius:20px; font-family:Inter,sans-serif; font-size:12px; font-weight:600; letter-spacing:-0.24px; line-height:16px; width:fit-content; }
.ds-status-pill .ds-dot { width:6px; height:6px; border-radius:50%; flex-shrink:0; }
.ds-st-active { background:#a7f3d0; color:#059669; }
.ds-st-active .ds-dot { background:#059669; }
.ds-st-inactive { background:#f1f5f9; color:#64748b; }
.ds-st-inactive .ds-dot { background:#64748b; }
.ds-st-review { background:#dbeafe; color:#2563eb; }
.ds-st-review .ds-dot { background:#2563eb; }`,
            previewHTML: `<div style="display:flex;gap:10px;flex-wrap:wrap;">
  <span class="ds-status-pill ds-st-active"><span class="ds-dot"></span>Active</span>
  <span class="ds-status-pill ds-st-inactive"><span class="ds-dot"></span>Inactive</span>
  <span class="ds-status-pill ds-st-review"><span class="ds-dot"></span>In review</span>
</div>`,
            css: `.status-pill {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 3px 8px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  letter-spacing: -0.24px;
  line-height: 16px;
  width: fit-content;
}
.status-pill .dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}
/* Variants */
.status-active  { background: #a7f3d0; color: #059669; }
.status-active .dot  { background: #059669; }
.status-inactive { background: #f1f5f9; color: #64748b; }
.status-inactive .dot { background: #64748b; }
.status-in-review { background: #dbeafe; color: #2563eb; }
.status-in-review .dot { background: #2563eb; }`,
            html: `<span class="status-pill status-active">
  <span class="dot"></span>Active
</span>`
          }
        ]
      },
      {
        category: 'Cards',
        items: [
          {
            name: 'Basic Card',
            previewCSS: `.ds-card {
  background:#fff; border:1px solid #e2e8f0;
  border-radius:8px; overflow:hidden; width:280px;
  font-family:Inter,sans-serif;
}
.ds-card-section { padding:16px 20px; font-size:14px; color:#334155; line-height:24px; }`,
            previewHTML: `<div class="ds-card">
  <div class="ds-card-section">Card content goes here.</div>
</div>`,
            css: `.card {
  background: #fff;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  overflow: hidden;
}
.card-section { padding: 16px 20px; }`,
            html: `<div class="card">
  <div class="card-section">
    Content goes here.
  </div>
</div>`
          },
          {
            name: 'Card with Sections',
            previewCSS: `.ds-card2 { background:#fff; border:1px solid #e2e8f0; border-radius:8px; overflow:hidden; width:280px; font-family:Inter,sans-serif; }
.ds-card2 .s { padding:16px 20px; }
.ds-card2 .d { height:1px; background:#e2e8f0; }
.ds-card2 .t { font-size:16px; font-weight:700; color:#334155; line-height:26px; margin-bottom:4px; }
.ds-card2 .b { font-size:14px; color:#64748b; line-height:24px; }`,
            previewHTML: `<div class="ds-card2">
  <div class="s"><div class="t">Section Title</div><div class="b">Section content and description.</div></div>
  <div class="d"></div>
  <div class="s"><div class="b">Second section content.</div></div>
</div>`,
            css: `.card {
  background: #fff;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  overflow: hidden;
}
.card-section { padding: 16px 20px; }
.card-divider { height: 1px; background: #e2e8f0; }`,
            html: `<div class="card">
  <div class="card-section">
    <h3>Section Title</h3>
    <p>Content here.</p>
  </div>
  <div class="card-divider"></div>
  <div class="card-section">
    <p>Another section.</p>
  </div>
</div>`
          },
          {
            name: 'Notification Card',
            previewCSS: `.ds-notif {
  background: #fff; border-radius: 12px; padding: 16px 20px;
  display: flex; align-items: center; gap: 12px;
  box-shadow: 0 10px 15px -3px rgba(0,0,0,.1), 0 4px 6px -2px rgba(0,0,0,.06);
  width: 360px; font-family: Inter, sans-serif;
}
.ds-notif-icon { width: 20px; height: 20px; flex-shrink: 0; }
.ds-notif-body { display: flex; flex-direction: column; gap: 3px; flex: 1; min-width: 0; }
.ds-notif-msg { font-size: 14px; font-weight: 600; color: #0f172a; letter-spacing: -0.28px; line-height: 20px; }
.ds-notif-sub { font-size: 13px; color: #64748b; letter-spacing: -0.26px; line-height: 18px; }
.ds-notif-dismiss { background: none; border: none; cursor: pointer; font-family: Inter, sans-serif; font-size: 13px; font-weight: 500; color: #2c66ef; padding: 0; width: fit-content; text-align: left; }
.ds-notif-dismiss:hover { text-decoration: underline; }`,
            previewHTML: `<div style="display:flex;flex-direction:column;gap:16px">
  <div class="ds-notif">
    <div class="ds-notif-icon">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" fill="#059669"/>
        <path d="M7 13l3 3 7-7" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <div class="ds-notif-body">
      <span class="ds-notif-msg">Verification email sent</span>
      <button class="ds-notif-dismiss">Dismiss</button>
    </div>
  </div>
  <div class="ds-notif">
    <div class="ds-notif-icon">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" fill="#f59e0b"/>
        <path d="M12 8v4M12 16h.01" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </div>
    <div class="ds-notif-body">
      <span class="ds-notif-msg">Action required</span>
      <span class="ds-notif-sub">Please complete your profile.</span>
      <button class="ds-notif-dismiss">Dismiss</button>
    </div>
  </div>
</div>`,
            css: `.notif-banner {
  position: fixed;
  top: 56px; right: 24px;
  width: 428px;
  max-width: calc(100vw - 32px);
  background: #fff;
  border-radius: 12px;
  padding: 16px 20px;
  display: flex;
  align-items: center;
  gap: 12px;
  box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1),
              0 4px 6px -2px rgba(0,0,0,0.06);
  z-index: 500;
  /* Hidden by default — slides in from right */
  transform: translateX(calc(100% + 48px));
  opacity: 0;
  transition: transform 0.4s cubic-bezier(0.25,0.46,0.45,0.94),
              opacity 0.3s ease;
  pointer-events: none;
}
.notif-banner.is-visible {
  transform: translateX(0);
  opacity: 1;
  pointer-events: auto;
}
.notif-icon { width: 20px; height: 20px; flex-shrink: 0; }
.notif-body {
  display: flex; flex-direction: column;
  gap: 3px; flex: 1; min-width: 0;
}
.notif-msg {
  font-size: 14px; font-weight: 600;
  color: #0f172a; letter-spacing: -0.28px; line-height: 20px;
}
.notif-dismiss {
  background: none; border: none; cursor: pointer;
  font-size: 13px; font-weight: 500;
  color: #2c66ef; padding: 0;
}
.notif-dismiss:hover { text-decoration: underline; }`,
            html: `<div class="notif-banner is-visible" id="notifBanner">
  <div class="notif-icon" id="notifIcon">
    <!-- inject icon svg -->
  </div>
  <div class="notif-body">
    <span class="notif-msg" id="notifMsg">
      Verification email sent
    </span>
    <button class="notif-dismiss"
            onclick="dismissBanner()">
      Dismiss
    </button>
  </div>
</div>`
          }
        ]
      },
      {
        category: 'Progress',
        items: [
          {
            name: 'Progress Bar',
            previewCSS: `.ds-pb-wrap { display:flex; flex-direction:column; gap:12px; width:280px; font-family:Inter,sans-serif; }
.ds-pb-label { font-size:14px; color:#64748b; }
.ds-pb { height:4px; background:#e2e8f0; border-radius:4px; overflow:hidden; }
.ds-pb-fill { height:100%; background:#197fe6; border-radius:4px; transition:width 0.3s ease; }`,
            previewHTML: `<div class="ds-pb-wrap">
  <div class="ds-pb-label">0% — Empty</div>
  <div class="ds-pb"><div class="ds-pb-fill" style="width:0%"></div></div>
  <div class="ds-pb-label">60% — In progress</div>
  <div class="ds-pb"><div class="ds-pb-fill" style="width:60%"></div></div>
  <div class="ds-pb-label">100% — Complete</div>
  <div class="ds-pb"><div class="ds-pb-fill" style="width:100%"></div></div>
</div>`,
            css: `.progress-bar {
  height: 4px;
  background: #e2e8f0;
  border-radius: 4px;
  overflow: hidden;
}
.progress-fill {
  height: 100%;
  background: #197fe6;
  border-radius: 4px;
  width: 0%;
  transition: width 0.3s ease;
}`,
            html: `<div class="progress-bar">
  <div class="progress-fill"
       style="width: 60%">
  </div>
</div>`
          }
        ]
      },
      {
        category: 'Navigation',
        items: [
          {
            name: 'Sidebar Nav Item',
            previewCSS: `.ds-sidebar-bg { background:#0f172a; border-radius:8px; padding:8px; width:220px; font-family:Inter,sans-serif; display:flex; flex-direction:column; gap:2px; }
.ds-nav-item { display:flex; align-items:center; gap:16px; padding:8px 16px; border-radius:8px; cursor:pointer; border:none; background:none; width:100%; }
.ds-nav-item:hover { background:rgba(255,255,255,0.06); }
.ds-nav-item.active { background:rgba(255,255,255,0.1); }
.ds-nav-label { flex:1; color:#fff; font-size:14px; font-weight:500; letter-spacing:-0.28px; line-height:24px; }
.ds-nav-icon { width:24px; height:24px; flex-shrink:0; color:#fff; }`,
            previewHTML: `<div class="ds-sidebar-bg">
  <button class="ds-nav-item active">
    <svg class="ds-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>
    <span class="ds-nav-label">To-Do</span>
  </button>
  <button class="ds-nav-item">
    <svg class="ds-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0"/></svg>
    <span class="ds-nav-label">Users</span>
  </button>
</div>`,
            css: `.nav-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
  width: 100%;
  background: none;
  border: none;
  font-family: inherit;
}
.nav-item:hover {
  background: rgba(255, 255, 255, 0.06);
}
.nav-label {
  flex: 1;
  color: #fff;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.28px;
  line-height: 24px;
}
.nav-icon {
  width: 24px;
  height: 24px;
  flex-shrink: 0;
  color: #fff;
}`,
            html: `<button class="nav-item">
  <svg class="nav-icon" viewBox="0 0 24 24"
       fill="none" stroke="currentColor"
       stroke-width="2">
    <!-- icon path -->
  </svg>
  <span class="nav-label">To-Do</span>
</button>`
          },
          {
            name: 'Avatar',
            previewCSS: `.ds-avatar-row { display:flex; align-items:center; gap:12px; font-family:Inter,sans-serif; }
.ds-avatar { border-radius:50%; background:#64748b; display:flex; align-items:center; justify-content:center; color:#fff; font-weight:600; flex-shrink:0; }
.ds-avatar-sm { width:32px; height:32px; font-size:11px; }
.ds-avatar-md { width:40px; height:40px; font-size:14px; }
.ds-avatar-lg { width:48px; height:48px; font-size:16px; }`,
            previewHTML: `<div class="ds-avatar-row">
  <div class="ds-avatar ds-avatar-sm">JL</div>
  <div class="ds-avatar ds-avatar-md">JL</div>
  <div class="ds-avatar ds-avatar-lg">JL</div>
</div>`,
            css: `.avatar {
  border-radius: 50%;
  background: #64748b;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-weight: 600;
  flex-shrink: 0;
}
/* Sizes */
.avatar-sm { width: 32px; height: 32px; font-size: 11px; }
.avatar-md { width: 40px; height: 40px; font-size: 14px; }
.avatar-lg { width: 48px; height: 48px; font-size: 16px; }`,
            html: `<div class="avatar avatar-sm">JL</div>
<div class="avatar avatar-md">JL</div>
<div class="avatar avatar-lg">JL</div>`
          },
          {
            name: 'Tab Switcher',
            previewCSS: `.ds-tab-switcher { display:inline-flex; align-items:center; border:1px solid #94a3b8; border-radius:10px; padding:4px; gap:0; }
.ds-tab { padding:4px 12px; border-radius:8px; border:none; background:transparent; font-family:Inter,sans-serif; font-size:14px; font-weight:500; color:#2c66ef; letter-spacing:-0.56px; line-height:24px; cursor:pointer; white-space:nowrap; transition:background 0.15s,color 0.15s; }
.ds-tab.is-active { background:#475569; color:#fff; }`,
            previewHTML: `<div class="ds-tab-switcher">
  <button class="ds-tab is-active">Sign in</button>
  <button class="ds-tab">Magic link</button>
</div>`,
            css: `.tab-switcher {
  display: inline-flex;
  align-items: center;
  border: 1px solid #94a3b8;
  border-radius: 10px;
  padding: 4px;
}
.tab {
  padding: 4px 12px;
  border-radius: 8px;
  border: none;
  background: transparent;
  font-size: 14px;
  font-weight: 500;
  color: #2c66ef;
  letter-spacing: -0.56px;
  line-height: 24px;
  cursor: pointer;
  white-space: nowrap;
  transition: background 0.15s, color 0.15s;
}
.tab.is-active {
  background: #475569;
  color: #fff;
}`,
            html: `<div class="tab-switcher">
  <button class="tab is-active">Tab 1</button>
  <button class="tab">Tab 2</button>
</div>`
          }
        ]
      },
      {
        category: 'Typography',
        items: [
          {
            name: 'Heading — Page (36px)',
            previewCSS: `.ds-h1 { font-family:Inter,sans-serif; font-size:36px; font-weight:600; color:#334155; letter-spacing:-1.44px; line-height:40px; }`,
            previewHTML: `<h1 class="ds-h1">Page Heading</h1>`,
            css: `.heading-page {
  font-size: 36px;
  font-weight: 600;
  color: #334155;
  letter-spacing: -1.44px;
  line-height: 40px;
}`,
            html: `<h1 class="heading-page">Page Heading</h1>`
          },
          {
            name: 'Heading — Section (20px)',
            previewCSS: `.ds-h2 { font-family:Inter,sans-serif; font-size:20px; font-weight:700; color:#334155; letter-spacing:-0.4px; line-height:30px; }`,
            previewHTML: `<h2 class="ds-h2">Section Heading</h2>`,
            css: `.heading-section {
  font-size: 20px;
  font-weight: 700;
  color: #334155;
  letter-spacing: -0.4px;
  line-height: 30px;
}`,
            html: `<h2 class="heading-section">Section Heading</h2>`
          },
          {
            name: 'Body Text (16px)',
            previewCSS: `.ds-body { font-family:Inter,sans-serif; font-size:16px; font-weight:400; color:#334155; line-height:26px; max-width:320px; }`,
            previewHTML: `<p class="ds-body">This is body text used for descriptions and general content throughout the application interface.</p>`,
            css: `.body-text {
  font-size: 16px;
  font-weight: 400;
  color: #334155;
  line-height: 26px;
}`,
            html: `<p class="body-text">Body copy goes here.</p>`
          },
          {
            name: 'Label (14px)',
            previewCSS: `.ds-label { font-family:Inter,sans-serif; font-size:14px; font-weight:500; color:#64748b; letter-spacing:-0.28px; line-height:24px; }`,
            previewHTML: `<span class="ds-label">Field label / Meta text</span>`,
            css: `.label-text {
  font-size: 14px;
  font-weight: 500;
  color: #64748b;
  letter-spacing: -0.28px;
  line-height: 24px;
}`,
            html: `<span class="label-text">Field label</span>`
          }
        ]
      },
      {
        category: 'Colors',
        items: [
          {
            name: 'Color Palette',
            previewCSS: `.ds-colors { display:flex; flex-wrap:wrap; gap:16px; font-family:Inter,sans-serif; max-width:440px; }
.ds-swatch-group { display:flex; flex-direction:column; gap:6px; align-items:center; }
.ds-swatch { width:56px; height:56px; border-radius:8px; border:1px solid rgba(0,0,0,0.08); }
.ds-swatch-name { font-size:10px; font-weight:600; color:#334155; text-align:center; line-height:14px; }
.ds-swatch-hex { font-size:10px; color:#94a3b8; text-align:center; font-family:'SF Mono',monospace; }`,
            previewHTML: `<div class="ds-colors">
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#2c66ef"></div><span class="ds-swatch-name">Primary</span><span class="ds-swatch-hex">#2c66ef</span></div>
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#197fe6"></div><span class="ds-swatch-name">Alt Blue</span><span class="ds-swatch-hex">#197fe6</span></div>
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#334155"></div><span class="ds-swatch-name">Text Dark</span><span class="ds-swatch-hex">#334155</span></div>
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#64748b"></div><span class="ds-swatch-name">Text Mid</span><span class="ds-swatch-hex">#64748b</span></div>
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#94a3b8"></div><span class="ds-swatch-name">Muted</span><span class="ds-swatch-hex">#94a3b8</span></div>
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#e2e8f0"></div><span class="ds-swatch-name">Border</span><span class="ds-swatch-hex">#e2e8f0</span></div>
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#f8fafc"></div><span class="ds-swatch-name">BG Light</span><span class="ds-swatch-hex">#f8fafc</span></div>
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#059669"></div><span class="ds-swatch-name">Success</span><span class="ds-swatch-hex">#059669</span></div>
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#ef4444"></div><span class="ds-swatch-name">Danger</span><span class="ds-swatch-hex">#ef4444</span></div>
  <div class="ds-swatch-group"><div class="ds-swatch" style="background:#ffaa00"></div><span class="ds-swatch-name">Warning</span><span class="ds-swatch-hex">#ffaa00</span></div>
</div>`,
            css: `/* Brand */
--color-primary:    #2c66ef;
--color-alt-blue:   #197fe6;

/* Text */
--color-text-dark:  #334155;
--color-text-mid:   #64748b;
--color-text-muted: #94a3b8;
--color-text-body:  #0f172a;

/* Borders & Backgrounds */
--color-border:     #e2e8f0;
--color-bg-light:   #f8fafc;
--color-bg-mid:     #f1f5f9;

/* Semantic */
--color-success:    #059669;
--color-danger:     #ef4444;
--color-warning:    #ffaa00;`,
            html: `<style>
  :root {
    --color-primary: #2c66ef;
    --color-success: #059669;
    --color-danger:  #ef4444;
    --color-warning: #ffaa00;
    --color-border:  #e2e8f0;
    --color-bg:      #f8fafc;
  }
</style>`
          }
        ]
      },
      {
        category: 'Tables',
        items: [
          {
            name: 'Data Table',
            previewCSS: `.ds-table-wrap { background:#fff; border:1px solid #e2e8f0; border-radius:8px; overflow:hidden; font-family:Inter,sans-serif; width:100%; max-width:560px; }
.ds-data-table { width:100%; border-collapse:collapse; }
.ds-data-table th { padding:10px 16px; text-align:left; font-size:12px; font-weight:600; color:#64748b; letter-spacing:-0.24px; line-height:16px; background:#f8fafc; border-bottom:1px solid #e2e8f0; white-space:nowrap; }
.ds-data-table td { padding:12px 16px; font-size:14px; color:#334155; letter-spacing:-0.28px; line-height:20px; border-bottom:1px solid #e2e8f0; }
.ds-data-table tbody tr:last-child td { border-bottom:none; }
.ds-data-table tbody tr:hover td { background:#f4f7fe; cursor:pointer; }`,
            previewHTML: `<div class="ds-table-wrap">
  <table class="ds-data-table">
    <thead><tr><th>Name</th><th>Status</th><th>Date</th></tr></thead>
    <tbody>
      <tr><td>Acme Corp</td><td>Active</td><td>12 Jan 2025</td></tr>
      <tr><td>Beta Ltd</td><td>In Review</td><td>5 Feb 2025</td></tr>
      <tr><td>Gamma Inc</td><td>Inactive</td><td>20 Mar 2025</td></tr>
    </tbody>
  </table>
</div>`,
            css: `.table-wrap {
  background: #fff;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  overflow: hidden;
}
.data-table {
  width: 100%;
  border-collapse: collapse;
}
.data-table th {
  padding: 10px 16px;
  text-align: left;
  font-size: 12px;
  font-weight: 600;
  color: #64748b;
  letter-spacing: -0.24px;
  line-height: 16px;
  background: #f8fafc;
  border-bottom: 1px solid #e2e8f0;
  white-space: nowrap;
}
.data-table td {
  padding: 12px 16px;
  font-size: 14px;
  color: #334155;
  letter-spacing: -0.28px;
  line-height: 20px;
  border-bottom: 1px solid #e2e8f0;
}
.data-table tbody tr:last-child td { border-bottom: none; }
.data-table tbody tr:hover td { background: #f4f7fe; cursor: pointer; }`,
            html: `<div class="table-wrap">
  <table class="data-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Status</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Row value</td>
        <td>Active</td>
        <td>12 Jan 2025</td>
      </tr>
    </tbody>
  </table>
</div>`
          }
        ]
      },
      {
        category: 'Overlays',
        items: [
          {
            name: 'Right Drawer',
            previewCSS: `.ds-drawer-demo { position:relative; height:180px; overflow:hidden; background:#f1f5f9; border-radius:8px; font-family:Inter,sans-serif; }
.ds-drawer { position:absolute; top:0; right:0; bottom:0; width:260px; background:#fff; display:flex; flex-direction:column; box-shadow:-4px 0 24px rgba(0,0,0,0.12); }
.ds-drawer-header { display:flex; align-items:center; padding:14px 16px; border-bottom:1px solid #e2e8f0; background:#f1f5f9; flex-shrink:0; }
.ds-drawer-title { flex:1; font-size:16px; font-weight:600; letter-spacing:-0.32px; line-height:24px; color:#334155; }
.ds-drawer-close { background:none; border:none; cursor:pointer; color:#64748b; padding:2px; display:flex; }
.ds-drawer-body { flex:1; overflow-y:auto; padding:16px; font-size:14px; color:#64748b; line-height:22px; }`,
            previewHTML: `<div class="ds-drawer-demo">
  <div class="ds-drawer">
    <div class="ds-drawer-header">
      <span class="ds-drawer-title">Drawer Title</span>
      <button class="ds-drawer-close"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg></button>
    </div>
    <div class="ds-drawer-body">Drawer content goes here.</div>
  </div>
</div>`,
            css: `.drawer-overlay {
  display: none;
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.4);
  z-index: 200;
}
.drawer-overlay.is-visible { display: block; }
.drawer {
  position: fixed;
  top: 0; right: 0; bottom: 0;
  width: 440px; max-width: 100vw;
  background: #fff;
  z-index: 201;
  display: flex; flex-direction: column;
  transform: translateX(100%);
  transition: transform 0.25s ease;
  box-shadow: -4px 0 24px rgba(0,0,0,0.12);
}
.drawer.is-open { transform: translateX(0); }
.drawer-header {
  display: flex; align-items: center;
  padding: 16px 24px;
  border-bottom: 1px solid #e2e8f0;
  background: #f1f5f9;
  flex-shrink: 0;
}
.drawer-title {
  flex: 1;
  font-size: 20px; font-weight: 600;
  letter-spacing: -0.4px; line-height: 26px;
  color: #334155;
}
.drawer-close {
  background: none; border: none;
  cursor: pointer; color: #64748b;
  padding: 4px; display: flex; align-items: center;
}
.drawer-body { flex: 1; overflow-y: auto; }`,
            html: `<div class="drawer-overlay" id="drawerOverlay"></div>
<div class="drawer" id="drawer">
  <div class="drawer-header">
    <span class="drawer-title">Drawer Title</span>
    <button class="drawer-close" onclick="closeDrawer()">
      <!-- close icon -->
    </button>
  </div>
  <div class="drawer-body">
    <!-- content -->
  </div>
</div>`
          },
          {
            name: 'Modal Dialog',
            previewCSS: `.ds-modal-backdrop { position:relative; height:180px; display:flex; align-items:center; justify-content:center; background:#f1f5f9; border-radius:8px; font-family:Inter,sans-serif; }
.ds-modal { background:#fff; border-radius:12px; padding:20px; width:260px; display:flex; flex-direction:column; gap:10px; box-shadow:0 8px 32px rgba(0,0,0,0.18); }
.ds-modal-title { font-size:15px; font-weight:600; color:#0f172a; letter-spacing:-0.3px; line-height:22px; }
.ds-modal-body { font-size:13px; color:#475569; letter-spacing:-0.26px; line-height:19px; }
.ds-modal-btns { display:flex; gap:8px; }
.ds-modal-btn-primary { flex:1; background:#2c66ef; color:#fff; border:none; border-radius:8px; padding:7px; font-family:inherit; font-size:13px; font-weight:500; cursor:pointer; }
.ds-modal-btn-ghost { flex:1; background:#fff; color:#334155; border:1px solid #e2e8f0; border-radius:8px; padding:7px; font-family:inherit; font-size:13px; font-weight:500; cursor:pointer; }`,
            previewHTML: `<div class="ds-modal-backdrop">
  <div class="ds-modal">
    <div class="ds-modal-title">Confirm action</div>
    <div class="ds-modal-body">Are you sure you want to proceed? This cannot be undone.</div>
    <div class="ds-modal-btns">
      <button class="ds-modal-btn-ghost">Cancel</button>
      <button class="ds-modal-btn-primary">Confirm</button>
    </div>
  </div>
</div>`,
            css: `.modal-backdrop {
  display: none;
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.45);
  z-index: 400;
  align-items: center;
  justify-content: center;
}
.modal-backdrop.is-visible { display: flex; }
.modal {
  background: #fff;
  border-radius: 12px;
  padding: 24px;
  width: 320px;
  max-width: calc(100vw - 32px);
  display: flex; flex-direction: column;
  gap: 12px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.18);
}
.modal-title {
  font-size: 16px; font-weight: 600;
  color: #0f172a; letter-spacing: -0.32px;
  line-height: 24px;
}
.modal-body {
  font-size: 14px; font-weight: 400;
  color: #475569; letter-spacing: -0.28px;
  line-height: 20px;
}
.modal-btns { display: flex; gap: 8px; }`,
            html: `<div class="modal-backdrop is-visible">
  <div class="modal">
    <div class="modal-title">Confirm action</div>
    <div class="modal-body">
      Are you sure? This cannot be undone.
    </div>
    <div class="modal-btns">
      <button class="btn-cancel">Cancel</button>
      <button class="btn-primary">Confirm</button>
    </div>
  </div>
</div>`
          }
        ]
      },
      {
        category: 'Feedback',
        items: [
          {
            name: 'Toast Notification',
            previewCSS: `.ds-toast { display:inline-flex; align-items:center; gap:10px; background:#0f172a; color:#fff; border-radius:10px; padding:12px 16px; font-family:Inter,sans-serif; font-size:14px; font-weight:500; letter-spacing:-0.28px; line-height:20px; box-shadow:0 4px 20px rgba(0,0,0,0.25); max-width:340px; }
.ds-toast-icon { width:20px; height:20px; flex-shrink:0; color:#34d399; }
.ds-toast-msg { flex:1; }
.ds-toast-dismiss { background:none; border:none; cursor:pointer; color:#94a3b8; padding:0; display:flex; font-family:inherit; font-size:13px; }
.ds-toast-dismiss:hover { color:#fff; }`,
            previewHTML: `<div class="ds-toast">
  <svg class="ds-toast-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg>
  <span class="ds-toast-msg">Changes saved successfully</span>
  <button class="ds-toast-dismiss">Dismiss</button>
</div>`,
            css: `.toast {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  background: #0f172a;
  color: #fff;
  border-radius: 10px;
  padding: 12px 16px;
  font-size: 14px;
  font-weight: 500;
  letter-spacing: -0.28px;
  line-height: 20px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.25);
  max-width: 360px;
}
.toast-icon { width: 20px; height: 20px; flex-shrink: 0; color: #34d399; }
.toast-dismiss {
  background: none; border: none;
  cursor: pointer; color: #94a3b8;
  font-size: 13px; font-family: inherit;
}
.toast-dismiss:hover { color: #fff; }`,
            html: `<div class="toast">
  <svg class="toast-icon" viewBox="0 0 24 24"
       fill="none" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round"
          d="M5 13l4 4L19 7"/>
  </svg>
  <span>Changes saved successfully</span>
  <button class="toast-dismiss">Dismiss</button>
</div>`
          },
          {
            name: 'Empty State',
            previewCSS: `.ds-empty { display:flex; flex-direction:column; align-items:center; justify-content:center; gap:12px; padding:40px 24px; text-align:center; font-family:Inter,sans-serif; }
.ds-empty-icon { width:56px; height:56px; color:#10b981; }
.ds-empty-msg { font-size:16px; font-weight:600; color:#64748b; letter-spacing:-0.32px; line-height:24px; }
.ds-empty-sub { font-size:14px; color:#94a3b8; line-height:22px; max-width:240px; }`,
            previewHTML: `<div class="ds-empty">
  <svg class="ds-empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
    <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
  </svg>
  <span class="ds-empty-msg">All clear!</span>
  <span class="ds-empty-sub">No outstanding items for now.</span>
</div>`,
            css: `.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 40px 24px;
  text-align: center;
}
.empty-state-icon {
  width: 56px; height: 56px;
  color: #10b981;
}
.empty-state-msg {
  font-size: 16px; font-weight: 600;
  color: #64748b; letter-spacing: -0.32px;
  line-height: 24px;
}
.empty-state-sub {
  font-size: 14px;
  color: #94a3b8;
  line-height: 22px;
  max-width: 280px;
}`,
            html: `<div class="empty-state">
  <svg class="empty-state-icon" viewBox="0 0 24 24"
       fill="none" stroke="currentColor" stroke-width="1.5">
    <!-- icon path -->
  </svg>
  <span class="empty-state-msg">Nothing here yet</span>
  <span class="empty-state-sub">Items will appear here once added.</span>
</div>`
          }
        ]
      }
    ];

    // ─── Used-on page map ─────────────────────────────────────────────────────
    const USED_ON = {
      'Primary Button':       [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' }],
      'Secondary Button':     [{ name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' }],
      'Outline Button':       [{ name: 'Compliance',      href: 'portal.html' }],
      'Disabled Button':      [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' },
                               { name: 'User Detail',     href: 'user-detail.html' }],
      'Pill Button (Active)': [{ name: 'Mobile Welcome',  href: 'mobile-welcome.html' },
                               { name: 'Mobile Req. Detail', href: 'mobile-requirement-detail.html' }],
      'Text Input':           [{ name: 'Login',           href: 'login.html' },
                               { name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' },
                               { name: 'Business Details',href: 'onboarding-business-details.html' },
                               { name: 'Key Contact',     href: 'onboarding-key-contact.html' },
                               { name: 'Business Address',href: 'onboarding-business-address.html' }],
      'Select':               [{ name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' }],
      'Checkbox':             [{ name: 'Compliance Docs', href: 'onboarding-compliance-docs.html' }],
      'Inline Field Edit':    [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'Company Details', href: 'company-details.html' }],
      'Tag: Caution':         [{ name: 'Mobile Welcome',  href: 'mobile-welcome.html' }],
      'Status: Approved':     [{ name: 'Compliance',      href: 'portal.html' }],
      'Status: In Review':    [{ name: 'Compliance',      href: 'portal.html' }],
      'Badge: Count':         [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'To-do',           href: 'todo.html' },
                               { name: 'Users',           href: 'users.html' }],
      'Basic Card':           [{ name: 'To-do',           href: 'todo.html' },
                               { name: 'Compliance',      href: 'portal.html' }],
      'Card with Sections':   [{ name: 'Business Details',href: 'onboarding-business-details.html' }],
      'Notification Card':    [{ name: 'Compliance',      href: 'portal.html' }],
      'Progress Bar':         [{ name: 'Business Details',href: 'onboarding-business-details.html' },
                               { name: 'Key Contact',     href: 'onboarding-key-contact.html' },
                               { name: 'Business Address',href: 'onboarding-business-address.html' },
                               { name: 'Compliance Docs', href: 'onboarding-compliance-docs.html' }],
      'Sidebar Nav Item':     [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'To-do',           href: 'todo.html' },
                               { name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' },
                               { name: 'User Detail',     href: 'user-detail.html' }],
      'Avatar':               [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'To-do',           href: 'todo.html' },
                               { name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' },
                               { name: 'User Detail',     href: 'user-detail.html' }],
      'Heading — Page (36px)':[{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'To-do',           href: 'todo.html' },
                               { name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' },
                               { name: 'User Detail',     href: 'user-detail.html' }],
      'Heading — Section (20px)':[{ name: 'To-do',        href: 'todo.html' },
                               { name: 'Company Details', href: 'company-details.html' }],
      'Body Text (16px)':     [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'To-do',           href: 'todo.html' },
                               { name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' },
                               { name: 'User Detail',     href: 'user-detail.html' }],
      'Label (14px)':         [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' }],
      'Color Palette':        [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'To-do',           href: 'todo.html' },
                               { name: 'Company Details', href: 'company-details.html' },
                               { name: 'Users',           href: 'users.html' },
                               { name: 'User Detail',     href: 'user-detail.html' },
                               { name: 'Login',           href: 'login.html' }],
      'Status Badge (Dot)':   [{ name: 'Users',           href: 'users.html' },
                               { name: 'Compliance',      href: 'portal.html' }],
      'Tab Switcher':         [{ name: 'Login',           href: 'login.html' }],
      'Data Table':           [{ name: 'Compliance',      href: 'portal.html' },
                               { name: 'Users',           href: 'users.html' }],
      'Right Drawer':         [{ name: 'Compliance',      href: 'portal.html' }],
      'Modal Dialog':         [{ name: 'Compliance',      href: 'portal.html' }],
      'Toast Notification':   [{ name: 'Compliance',      href: 'portal.html' }],
      'Empty State':          [{ name: 'To-do',           href: 'todo.html' }],
    };

    // ─── Render Nav ───────────────────────────────────────────────────────────
    const navPanel = document.getElementById('navPanel');

    DS.forEach((group, gi) => {
      const catGroup = document.createElement('div');
      catGroup.className = 'cat-group';

      const header = document.createElement('button');
      header.className = 'cat-header';
      header.innerHTML = `<span>${group.category}</span><svg class="cat-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>`;

      const itemsList = document.createElement('div');
      itemsList.className = 'cat-items';

      group.items.forEach((item, ii) => {
        const wrap = document.createElement('div');
        wrap.className = 'cat-item-wrap';
        const tree = document.createElement('div');
        tree.className = 'cat-item-tree';
        const btn = document.createElement('button');
        btn.className = 'cat-item';
        btn.textContent = item.name;
        btn.dataset.gi = gi;
        btn.dataset.ii = ii;
        btn.addEventListener('click', () => selectItem(gi, ii, btn));
        wrap.appendChild(tree);
        wrap.appendChild(btn);
        itemsList.appendChild(wrap);
      });

      header.addEventListener('click', () => toggleCat(gi, header, itemsList));
      catGroup.appendChild(header);
      catGroup.appendChild(itemsList);
      navPanel.appendChild(catGroup);
    });

    // Open first category and select first item
    const firstHeader = navPanel.querySelector('.cat-header');
    const firstItems  = navPanel.querySelector('.cat-items');
    if (firstHeader && firstItems) {
      firstHeader.classList.add('open');
      firstItems.classList.add('open');
      const firstBtn = firstItems.querySelector('.cat-item');
      if (firstBtn) firstBtn.click();
    }

    function toggleCat(gi, header, itemsList) {
      const isOpen = itemsList.classList.contains('open');
      document.querySelectorAll('.cat-header').forEach(h => h.classList.remove('open'));
      document.querySelectorAll('.cat-items').forEach(l => l.classList.remove('open'));
      if (!isOpen) {
        header.classList.add('open');
        itemsList.classList.add('open');
      }
    }

    // ─── Search filter ────────────────────────────────────────────────────────
    document.getElementById('navSearch').addEventListener('input', function () {
      const q = this.value.trim().toLowerCase();
      document.querySelectorAll('.cat-group').forEach(group => {
        const header   = group.querySelector('.cat-header');
        const itemsList = group.querySelector('.cat-items');
        let anyVisible = false;
        group.querySelectorAll('.cat-item-wrap').forEach(wrap => {
          const btn   = wrap.querySelector('.cat-item');
          const match = !q || btn.textContent.toLowerCase().includes(q);
          wrap.style.display = match ? '' : 'none';
          if (match) anyVisible = true;
        });
        group.style.display = anyVisible ? '' : 'none';
        if (q && anyVisible) {
          header.classList.add('open');
          itemsList.classList.add('open');
        }
      });
    });

    // ─── Preview style tag ────────────────────────────────────────────────────
    const previewStyleEl = document.createElement('style');
    previewStyleEl.id = 'ds-preview-style';
    document.head.appendChild(previewStyleEl);

    function selectItem(gi, ii, btn) {
      document.querySelectorAll('.cat-item').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      const item = DS[gi].items[ii];

      // Update preview style + HTML
      previewStyleEl.textContent = item.previewCSS;
      document.getElementById('previewName').textContent = item.name;
      document.getElementById('previewCanvas').innerHTML = item.previewHTML;

      // Update specs panel
      const specsBody = document.getElementById('specsBody');
      specsBody.className = 'specs-body';

      const pages = USED_ON[item.name] || [];
      const pageIcon = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>`;
      const usedOnBlock = pages.length ? `
        <div class="spec-block">
          <div class="spec-card">
            <div class="spec-card-header">
              <span class="spec-card-label">USED ON</span>
            </div>
            <div class="used-on-list">
              ${pages.map(p => `<a href="${p.href}" class="used-on-link" target="_blank">${pageIcon}${p.name}</a>`).join('')}
            </div>
          </div>
        </div>` : '';

      specsBody.innerHTML = `
        <div class="spec-block">
          <div class="spec-card">
            <div class="spec-card-header">
              <span class="spec-card-label">CSS</span>
              <button class="spec-copy-btn" data-copy="css" title="Copy CSS">
                ${copyIcon()}
              </button>
            </div>
            <pre class="spec-code">${highlightCSS(item.css)}</pre>
          </div>
        </div>
        <div class="spec-block">
          <div class="spec-card">
            <div class="spec-card-header">
              <span class="spec-card-label">HTML</span>
              <button class="spec-copy-btn" data-copy="html" title="Copy HTML">
                ${copyIcon()}
              </button>
            </div>
            <pre class="spec-code">${highlightHTML(item.html)}</pre>
          </div>
        </div>
        ${usedOnBlock}
      `;

      // Attach copy handlers
      specsBody.querySelectorAll('.spec-copy-btn').forEach(copyBtn => {
        copyBtn.addEventListener('click', () => {
          const type = copyBtn.dataset.copy;
          const text = type === 'css' ? item.css : item.html;
          navigator.clipboard.writeText(text).then(() => {
            copyBtn.classList.add('copied');
            copyBtn.innerHTML = checkIcon();
            setTimeout(() => {
              copyBtn.classList.remove('copied');
              copyBtn.innerHTML = copyIcon();
            }, 1500);
          });
        });
      });
    }

    function escHtml(str) {
      return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
    }

    // ── CSS syntax highlighter ────────────────────────────────────────────────
    function highlightCSS(raw) {
      function esc(s) { return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
      function sp(col, txt) { return '<span style="color:' + col + '">' + txt + '</span>'; }

      function colorVal(val) {
        val = val.trim();
        if (/^#[0-9a-fA-F]{3,8}$/.test(val)) return sp('#86efac', esc(val));
        if (/^-?\d+(\.\d+)?(px|em|rem|%|vh|vw|s|ms|deg|turn)?$/.test(val)) return sp('#fbbf24', esc(val));
        if (/^rgba?\(|^hsla?\(/.test(val)) return sp('#86efac', esc(val));
        // Try to highlight hex colors within complex values
        const hParts = val.split(/(#[0-9a-fA-F]{3,8})/g);
        if (hParts.length > 1) {
          return hParts.map((p, i) => (i % 2 === 1) ? sp('#86efac', esc(p)) : sp('#94a3b8', esc(p))).join('');
        }
        return sp('#94a3b8', esc(val));
      }

      return raw.split('\n').map(line => {
        const t = line.trim();
        if (!t) return '';

        // Comment
        if (t.startsWith('/*') || t.startsWith('//')) return sp('#6a9955', esc(line));

        // Standalone closing brace
        if (t === '}') return sp('#94a3b8', esc(line));

        // Inline rule: selector { prop: val; } or selector { prop: val; prop: val; }
        const m1 = line.match(/^(\s*)(.*?)\s*\{\s*(.+?)\s*\}\s*$/);
        if (m1 && !m1[2].includes('{') && !m1[3].includes('{')) {
          const [, indent, sel, body] = m1;
          const pm = body.match(/^(--?[\w-]+)\s*:\s*(.+?)\s*;?$/);
          let bodyHtml = esc(body);
          if (pm) {
            bodyHtml = sp('#9cdcfe', esc(pm[1])) + sp('#94a3b8', ': ') + colorVal(pm[2]) + sp('#94a3b8', ';');
          }
          return esc(indent) + sp('#4ec9b0', esc(sel.trim())) + sp('#94a3b8', ' { ') + bodyHtml + sp('#94a3b8', ' }');
        }

        // Selector line ending with {
        if (t.endsWith('{')) {
          const m2 = line.match(/^(\s*)(.*?)\s*\{\s*$/);
          if (m2) return esc(m2[1]) + sp('#4ec9b0', esc(m2[2].trim())) + ' ' + sp('#94a3b8', '{');
        }

        // Property/variable line
        const m3 = line.match(/^(\s*)(--?[\w-]+)\s*:\s*(.+?)\s*(;?)\s*$/);
        if (m3) {
          const [, indent, prop, val, semi] = m3;
          const pCol = prop.startsWith('--') ? '#4ec9b0' : '#9cdcfe';
          return esc(indent) + sp(pCol, esc(prop)) + sp('#94a3b8', ': ') + colorVal(val) + (semi ? sp('#94a3b8', ';') : '');
        }

        return esc(line);
      }).join('\n');
    }

    // ── HTML syntax highlighter ───────────────────────────────────────────────
    function highlightHTML(raw) {
      function esc(s) { return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
      function sp(col, txt) { return '<span style="color:' + col + '">' + txt + '</span>'; }

      let result = '';
      let i = 0;
      while (i < raw.length) {
        if (raw[i] !== '<') {
          let j = i;
          while (j < raw.length && raw[j] !== '<') j++;
          result += esc(raw.slice(i, j));
          i = j;
          continue;
        }

        // HTML comment
        if (raw.substr(i, 4) === '<!--') {
          const ce = raw.indexOf('-->', i);
          const end = ce !== -1 ? ce + 3 : raw.length;
          result += sp('#6a9955', esc(raw.slice(i, end)));
          i = end;
          continue;
        }

        // Find end of tag (skip over quoted attr values)
        let j = i + 1;
        let inQ = false, qC = '';
        while (j < raw.length) {
          if (inQ) { if (raw[j] === qC) inQ = false; }
          else if (raw[j] === '"' || raw[j] === "'") { inQ = true; qC = raw[j]; }
          else if (raw[j] === '>') break;
          j++;
        }
        const inner = raw.slice(i + 1, j);
        i = j + 1;

        // Closing tag
        if (inner.startsWith('/')) {
          result += sp('#94a3b8', '&lt;/') + sp('#4ec9b0', esc(inner.slice(1).trim())) + sp('#94a3b8', '&gt;');
          continue;
        }

        // Self-closing or opening tag
        const selfClose = inner.endsWith('/');
        const tagStr = selfClose ? inner.slice(0, -1).trim() : inner;
        const nMatch = tagStr.match(/^([\w:-]+)([\s\S]*)$/);
        if (!nMatch) {
          result += sp('#94a3b8', '&lt;') + esc(inner) + sp('#94a3b8', '&gt;');
          continue;
        }
        const [, tagName, attrsRaw] = nMatch;

        // Process attributes
        let attrHtml = '';
        let lastIdx = 0;
        const attrRe = /(\s+)([\w:-]+)(?:(\s*=\s*)(["'])([\s\S]*?)\4)?/g;
        let am;
        while ((am = attrRe.exec(attrsRaw)) !== null) {
          if (am.index > lastIdx) attrHtml += esc(attrsRaw.slice(lastIdx, am.index));
          attrHtml += esc(am[1]) + sp('#9cdcfe', esc(am[2]));
          if (am[3] && am[4]) attrHtml += sp('#94a3b8', esc(am[3])) + sp('#ce9178', esc(am[4] + am[5] + am[4]));
          lastIdx = am.index + am[0].length;
        }
        if (lastIdx < attrsRaw.length) attrHtml += esc(attrsRaw.slice(lastIdx));

        result += sp('#94a3b8', '&lt;') + sp('#4ec9b0', esc(tagName)) + attrHtml
                + (selfClose ? sp('#94a3b8', ' /&gt;') : sp('#94a3b8', '&gt;'));
      }
      return result;
    }
    function copyIcon() {
      return `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>`;
    }
    function checkIcon() {
      return `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg>`;
    }

    // ─── Check for new components ─────────────────────────────────────────────
    // Fingerprint: a map from a distinctive CSS class → DS component name.
    // If a prototype page contains this class, that component is "known".
    const DS_FINGERPRINTS = {
      // Buttons
      'btn-primary':'Primary Button','btn-secondary':'Secondary Button',
      'btn-outline':'Outline Button','btn-disabled':'Disabled Button',
      'btn-save':'Primary Button','btn-cancel':'Secondary Button',
      'btn-signin':'Primary Button','btn-continue':'Primary Button',
      'btn-next':'Primary Button','btn-back':'Secondary Button',
      'btn-send':'Primary Button','pill-btn':'Pill Button (Active)',
      // Form controls
      'form-input':'Text Input','form-select':'Select','form-checkbox':'Checkbox',
      'form-field':'Text Input','form-label':'Text Input',
      'form-fields':'Text Input','form-area':'Text Input',
      'inline-edit':'Inline Field Edit',
      // Badges & Tags
      'tag-caution':'Tag: Caution','status-approved':'Status: Approved',
      'status-in-review':'Status: In Review','status-pill':'Status Badge (Dot)',
      'status-active':'Status Badge (Dot)','status-inactive':'Status Badge (Dot)',
      'status-row':'Status Badge (Dot)','status-count':'Status Badge (Dot)',
      'badge':'Badge: Count',
      // Cards
      'card':'Basic Card','card-section':'Basic Card','card-divider':'Basic Card',
      'card-heading':'Basic Card','card-logo':'Basic Card','card-actions':'Basic Card',
      'notification':'Notification Card','notif-banner':'Notification Card',
      'notif-icon':'Notification Card','notif-body':'Notification Card',
      'notif-msg':'Notification Card',
      // Progress
      'progress-bar':'Progress Bar','progress-fill':'Progress Bar',
      'progress-title':'Progress Bar',
      // Navigation
      'nav-item':'Sidebar Nav Item','nav-row':'Sidebar Nav Item',
      'nav-spacer':'Sidebar Nav Item','avatar':'Avatar',
      'tab-switcher':'Tab Switcher','tab-group':'Tab Switcher',
      'tab-label':'Tab Switcher','tab':'Tab Switcher',
      // Tables
      'data-table':'Data Table','table-wrap':'Data Table',
      'table-section':'Data Table','table-toolbar':'Data Table',
      // Overlays
      'drawer':'Right Drawer','drawer-overlay':'Right Drawer',
      'drawer-close':'Right Drawer','modal':'Modal Dialog',
      'modal-backdrop':'Modal Dialog',
      // Feedback
      'toast':'Toast Notification','empty-state':'Empty State',
    };

    const PROTOTYPE_PAGES = [
      { name: 'Login',             href: 'login.html' },
      { name: 'Onboarding Welcome',href: 'onboarding-welcome.html' },
      { name: 'Business Details',  href: 'onboarding-business-details.html' },
      { name: 'Key Contact',       href: 'onboarding-key-contact.html' },
      { name: 'Business Address',  href: 'onboarding-business-address.html' },
      { name: 'Compliance Docs',   href: 'onboarding-compliance-docs.html' },
      { name: 'Onboarding Success',href: 'onboarding-success.html' },
      { name: 'Compliance',        href: 'portal.html' },
      { name: 'To-do',             href: 'todo.html' },
      { name: 'Company Details',   href: 'company-details.html' },
      { name: 'Users',             href: 'users.html' },
      { name: 'User Detail',       href: 'user-detail.html' },
      { name: 'Add User',          href: 'add-user.html' },
      { name: 'Mobile Welcome',    href: 'mobile-welcome.html' },
      { name: 'Mobile Requirements',href:'mobile-requirements.html' },
      { name: 'Mobile Req. Detail',href: 'mobile-requirement-detail.html' },
    ];

    async function checkForNewComponents() {
      const btn = document.getElementById('checkBtn');
      const overlay = document.getElementById('checkOverlay');
      const title = document.getElementById('checkDialogTitle');
      const body = document.getElementById('checkResultBody');

      btn.classList.add('running');
      title.textContent = 'Checking prototype pages…';
      body.innerHTML = '<div style="color:#64748b;font-size:13px;padding:8px 0;">Scanning for components…</div>';
      overlay.classList.add('is-open');

      // Collect all known DS class fingerprints
      const knownClasses = new Set(Object.keys(DS_FINGERPRINTS));

      // Track: class → pages where found
      const unknownClassPages = {};

      let fetched = 0;
      await Promise.all(PROTOTYPE_PAGES.map(async (page) => {
        try {
          const res = await fetch(page.href);
          const html = await res.text();
          // Extract class names from class="..." attributes
          const classRe = /class=["']([^"']+)["']/g;
          let m;
          const pageClasses = new Set();
          while ((m = classRe.exec(html)) !== null) {
            m[1].split(/\s+/).forEach(c => { if (c) pageClasses.add(c); });
          }
          // Also scan style blocks for CSS selectors that look component-like
          pageClasses.forEach(cls => {
            // Skip utility / layout / proto-nav / known DS classes
            if (knownClasses.has(cls)) return;
            if (/^(proto|map|is-|no-|ds-|check-|ap-|cd-|deact-|share-)/.test(cls)) return;
            if (/^(page|body|main|nav|header|footer|btn|form|logo|mob|card|tab|drawer|modal|toast|status|badge|tag|notif|avatar|progress|empty|inline|pill|table|data)/.test(cls)) {
              // Could be a component pattern — check if it looks "new"
              const base = cls.replace(/[-_](wrap|inner|item|header|body|footer|label|title|icon|btn|row|col|list|text|desc|link|btn|group|section|panel|card|name|img|tag|meta)$/, '');
              if (!knownClasses.has(base) && base.length > 3) {
                if (!unknownClassPages[cls]) unknownClassPages[cls] = [];
                unknownClassPages[cls].push(page.name);
              }
            }
          });
          fetched++;
        } catch (e) { /* skip */ }
      }));

      btn.classList.remove('running');
      title.textContent = `Scan complete — ${fetched} pages checked`;

      // Consolidate: group by root class, dedupe pages
      const grouped = {};
      Object.entries(unknownClassPages).forEach(([cls, pages]) => {
        const root = cls.split('-')[0];
        if (!grouped[root]) grouped[root] = { classes: [], pages: new Set() };
        grouped[root].classes.push(cls);
        pages.forEach(p => grouped[root].pages.add(p));
      });

      const entries = Object.entries(grouped).slice(0, 12); // limit display

      if (entries.length === 0) {
        body.innerHTML = `<div class="check-result-empty">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2" style="display:inline-block;vertical-align:middle;margin-right:6px">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
          </svg>
          All components appear to be documented in the design system.
        </div>`;
      } else {
        body.innerHTML = `
          <div style="font-size:13px;color:#64748b;margin-bottom:4px;">${entries.length} potential new component pattern${entries.length > 1 ? 's' : ''} found:</div>
          <div class="check-result-list">
            ${entries.map(([root, info]) => `
              <div class="check-result-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/></svg>
                <div>
                  <div class="ri-label">.${info.classes.slice(0,3).join(', .')}</div>
                  <div class="ri-detail">Found on: ${[...info.pages].join(', ')}</div>
                </div>
              </div>`).join('')}
          </div>
          <div style="font-size:12px;color:#94a3b8;margin-top:8px;">Review these patterns and add them to the DS array if they are reusable components.</div>`;
      }
    }

    // Last updated
    (function() {
      var d = new Date(document.lastModified);
      var pad = function(n) { return String(n).padStart(2, '0'); };
      document.getElementById('protoLastUpdated').textContent =
        'Last updated ' + pad(d.getDate()) + '/' + pad(d.getMonth()+1) + '/' + d.getFullYear() +
        ' ' + pad(d.getHours()) + ':' + pad(d.getMinutes()) + ':' + pad(d.getSeconds());
    })();
  </script>
  <script>if(window.self!==window.top){var n=document.querySelector(".proto-nav");if(n)n.style.display="none";document.body.style.paddingTop="0";}</script>
</body>
</html>
